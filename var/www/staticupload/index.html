<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<title>Test File Upload</title>
</head>

<body>
	<h1>File Upload without CGI</h1>

	<form id="uploadForm" method="POST" action="/upload" enctype="multipart/form-data">
		<label for="myFile">Choose a file:</label>
		<input type="file" id="myFile" name="myFile" />
		<button type="submit">Upload</button>
	</form>

	<hr />

	<h2>Upload via JavaScript Fetch:</h2>
	<input type="file" id="jsFile" />
	<button id="jsUploadBtn">Hochladen mit Fetch</button>

	<script>
		document.getElementById('jsUploadBtn').addEventListener('click', async () => {
			const fileInput = document.getElementById('jsFile');
			if (!fileInput.files[0]) {
				alert('No file chosen!');
				return;
			}

			const formData = new FormData();
			formData.append('myFile', fileInput.files[0]);

			try {
				const response = await fetch('/upload', {
					method: 'POST',
					body: formData,
				});
				if (response.ok) {
					alert('File sucessfully uploaded.');
				} else {
					alert('Upload failed: ' + response.status);
				}
			} catch (err) {
				console.error('Error Fetch-Upload:', err);
			}
		});
	</script>
</body>

</html>